"use server";

import { redirect } from "next/navigation";
import { NextResponse } from "next/server";

export async function logInternalServer(formData: FormData) {
  "use server";
  const message = formData.get("message");
  const secretKey = formData.get("secret-key");

  if (secretKey !== process.env.SECRET_KEY) {
    return NextResponse.json({ error: "Invalid secret key" }, { status: 403 });
  }

  await fetch("http://flaskapp:5000/log", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
    },
    body: JSON.stringify({
      message: message,
    }),
  });

  redirect("/log");
}
